#!/bin/bash

# ุณูุฑูุจุช ุจุฏุก ูุดุฑูุน YEMEN FLIX
echo "๐ ุจุฏุก ูุดุฑูุน YEMEN FLIX..."

# ุงูุชุญูู ูู ุงูุชุจุนูุงุช
if [ ! -d "node_modules" ]; then
  echo "๐ฆ ุชุซุจูุช ุงูุชุจุนูุงุช..."
  npm install
fi

# ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุฅุฐุง ุชููุฑุช)
if [ ! -z "$DATABASE_URL" ]; then
  echo "๐๏ธ ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช..."
  npm run db:push 2>/dev/null || echo "โ๏ธ ุชุญุฐูุฑ: ูุง ูููู ุชุทุจูู schema"
  node create-schema.js 2>/dev/null || echo "โ๏ธ ุชุญุฐูุฑ: ูุง ูููู ุฅุถุงูุฉ ุงูุจูุงูุงุช ุงูุฃูููุฉ"
fi

# ุจุฏุก ุงูุชุทุจูู
echo "โ ุจุฏุก ุงูุฎุงุฏู ุนูู ุงููููุฐ 5000..."
echo "๐ ุงูุชุญ ุงููุชุตูุญ ุนูู: http://localhost:5000"
echo "๐ง ููุญุฉ ุงูุชุญูู: ุงููุฑ 5 ูุฑุงุช ุนูู ุงูุดุนุงุฑ"
npm run dev