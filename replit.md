# مشروع AK.SV - نسخة يمنية من موقع اكوام

## نظرة عامة
هذا مشروع منصة أفلام ومسلسلات عربية تحاكي تصميم ووظائف موقع ak.sv الأصلي. المشروع يستخدم تقنيات حديثة مع تصميم يمني أصيل.

## الحالة الحالية (16 يوليو 2025 - التحديث الأخير - نظام ServerData التجريبي الشامل)

### 📌 ملاحظات مهمة من المستخدم حول هيدر ak.sv الأصلي:
- **قائمة "الأقسام"**: موجودة في شريط التنقل العلوي
- **التفعيل**: بالضغط (click) وليس المرور (hover)
- **التصميم**: قائمة منسدلة بخلفية داكنة بدون حدود بارزة
- **المحتوى**: روابط جميع الأقسام (أفلام، مسلسلات، منوعات، إلخ)
- **النسخة المحمولة**: تظهر ضمن الـ Sidebar المنبثقة
- ✅ **المشروع يعمل بنجاح** - الخادم يعمل على المنفذ 5000
- ✅ **قاعدة البيانات محلية** - يستخدم serverdb/database.json مع 24 محتوى
- ✅ **واجهة عربية كاملة** - RTL مع تصميم ak.sv الأصلي
- ✅ **الأقسام الموجودة**: أفلام، مسلسلات، تلفزيون، منوعات
- ✅ **الأقسام الجديدة المضافة**: البرامج والكورسات، الألعاب، التطبيقات، المسرحيات، المصارعة، الرياضة
- ✅ **نظام المراجعات والتقييمات** - يعمل بشكل كامل
- ✅ **البحث والفلاتر** - فلاتر متقدمة للمحتوى
- ✅ **الهيدر المبسط** - تم حذف شريط التنقل الفرعي (المنوعات، البرامج، الألعاب، إلخ)
- ✅ **LoadingSpinner مُصلح** - يعمل بشكل صحيح في جميع الصفحات الجديدة
- ✅ **صفحة "أُضيف حديثاً"** - `/recent` مع فلاتر متقدمة للمحتوى الجديد
- ✅ **صفحة المشاهدة** - `/watch` مع مشغل فيديو ونظام تبليغ
- ✅ **الفلاتر المتقدمة** - component شامل للفلاتر حسب الموقع الأصلي
- ✅ **رابط "أُضيف حديثاً"** - مُضاف للهيدر مع أيقونة الساعة
- ✅ **قائمة الأقسام في الهيدر** - قائمة منسدلة بالنقر (16 يوليو 2025)
- ✅ **نظام الحلقات المُحسن** - إصلاح عرض الحلقات مع دعم season_number و episode_number
- ✅ **نظام التحميل المُحسن** - إضافة روابط تحميل للحلقات المفقودة
- ✅ **الاختبارات الشاملة** - فحص جميع الأنواع وأنظمة التحميل والحلقات
- ✅ **نظام ServerData التجريبي** - قاعدة بيانات تجريبية شاملة مع إعداد تلقائي
- ✅ **التهيئة التلقائية** - سكربت setup.cjs للإعداد التلقائي عند التشغيل
- ✅ **النسخ الاحتياطية** - نظام نسخ احتياطي تلقائي مع إدارة الملفات
- ✅ **العزل الآمن** - جميع العمليات محصورة في مجلد serverdata

## 🔧 نظام ServerData التجريبي (مكتمل بنجاح)

### 📁 هيكل المجلد
```
serverdata/
├── database.json           # قاعدة البيانات التجريبية الرئيسية
├── database-manager.js     # مدير قاعدة البيانات
├── setup.cjs              # سكربت الإعداد التلقائي الرئيسي
├── init-database.cjs      # مُهيئ قاعدة البيانات
├── config.cjs             # إعدادات النظام
├── index.cjs              # نقطة الدخول الرئيسية
├── README.md              # توثيق شامل للنظام
├── images/                # صور المحتوى (24 صورة SVG)
├── backups/               # النسخ الاحتياطية التلقائية
├── logs/                  # سجلات النظام
└── temp/                  # ملفات مؤقتة
```

### 🚀 الميزات المُنجزة
1. **التهيئة التلقائية**: يتم تشغيل `setup.cjs` تلقائياً عند كل تشغيل
2. **قاعدة البيانات الشاملة**: 24 محتوى + 6 حلقات + 10 روابط تحميل + 2 روابط مشاهدة
3. **النسخ الاحتياطية**: نسخ احتياطية تلقائية مع timestamp
4. **العزل الآمن**: جميع العمليات محصورة في مجلد serverdata
5. **إدارة الصور**: نظام صور متكامل مع دعم SVG
6. **إعدادات قابلة للتخصيص**: ملف config.cjs شامل

### 🔄 طريقة العمل
- عند تشغيل المشروع، يتحقق النظام من وجود `serverdata/`
- إذا موجود: يستخدم قاعدة البيانات التجريبية
- إذا غير موجود: يرجع إلى `serverdb/` الاحتياطية
- يتم تشغيل `setup.cjs` تلقائياً لضمان سلامة النظام

### 📊 إحصائيات النظام
- **المستخدمون**: 1 (مدير)
- **الفئات**: 10 (عربي، أجنبي، إلخ)
- **الأنواع**: 15 (أكشن، دراما، كوميديا، إلخ)
- **المحتوى**: 24 (أفلام، مسلسلات، برامج، إلخ)
- **الحلقات**: 6 (للمسلسلات)
- **روابط التحميل**: 10 (جودات مختلفة)
- **روابط المشاهدة**: 2 (للأفلام)

### ✅ متطلبات المستخدم المُنجزة
1. ✅ **مجلد serverdata**: تم إنشاؤه مع قاعدة بيانات شاملة
2. ✅ **التهيئة التلقائية**: setup.cjs يعمل تلقائياً عند التشغيل
3. ✅ **السكربت التلقائي**: مدمج في server/index.ts
4. ✅ **إعدادات الاتصال**: النظام يستخدم serverdata تلقائياً
5. ✅ **العزل الآمن**: جميع العمليات محصورة في serverdata
6. ✅ **العمل المستقل**: لا يتطلب أي خطوات يدوية إضافية

## الأقسام المفقودة من الموقع الأصلي
بعد البحث عن ak.sv الأصلي، تم تحديد 6 أقسام مفقودة:
1. **البرامج والكورسات** (`/programs`)
2. **الألعاب** (`/games`) 
3. **التطبيقات** (`/applications`)
4. **المسرحيات** (`/theater`)
5. **المصارعة** (`/wrestling`)
6. **الرياضة** (`/sports`)

## البنية التقنية
- **Frontend**: React + TypeScript + Tailwind CSS
- **Backend**: Express.js + TypeScript
- **Database**: JSON محلي (serverdata/database.json - تجريبي، serverdb/database.json - احتياطي)
- **Authentication**: نظام مستخدمين بسيط
- **Storage**: نظام تخزين محلي مع ServerDBStorage
- **Auto-Setup**: نظام إعداد تلقائي مع ServerData

## الملفات الرئيسية
- `server/index.ts` - الخادم الرئيسي مع إعداد ServerData
- `server/serverdb-storage.ts` - نظام قاعدة البيانات مع دعم serverdata
- `serverdata/database.json` - قاعدة البيانات التجريبية الرئيسية
- `serverdata/setup.cjs` - سكربت الإعداد التلقائي
- `serverdata/config.cjs` - إعدادات النظام التجريبي
- `serverdb/database.json` - قاعدة البيانات الاحتياطية
- `client/src/App.tsx` - التطبيق الرئيسي
- `client/src/components/layout/ak-sv-header.tsx` - الهيدر
- `client/src/components/home/ak-sv-homepage.tsx` - الصفحة الرئيسية `/`
- `client/src/pages/ones.tsx` - الصفحة الرئيسية للموقع الأصلي `/ones`

## 👤 تفضيلات المستخدم (مهمة جداً)
- **اللغة**: العربية حصرياً
- **التصميم**: تطبيق ak.sv الأصلي بالكامل
- **التواصل**: لغة بسيطة ومفهومة
- **النشر**: رفع التغييرات على GitHub بعد كل تطوير
- **المخاوف الأساسية**: تجنب المشاكل والتضارب عند استيراد المشروع من GitHub
- **تفضيل الهيدر**: هيدر مبسط بدون شريط التنقل الفرعي
- **أولوية الاستقرار**: عدم تكرار نفس الإصلاحات عند الاستيراد من GitHub
- **🔥 مشكلة GitHub**: المستخدم يرفع التغييرات إلى GitHub، وعند الاستيراد تحدث مشاكل:
  - تكرار نفس الإصلاحات
  - إعطاء تقارير مختلفة
  - عدم تذكر الحالة السابقة
  - **الحل**: قراءة هذا الملف دائماً قبل أي تطوير

## 🚨 مشاكل يجب تجنبها عند الاستيراد من GitHub:
⚠️ **مشاكل LoadingSpinner**: التأكد من import صحيح في جميع الصفحات الجديدة
⚠️ **API endpoints مفقودة**: التأكد من وجود routes للأقسام الجديدة في server/routes.ts
⚠️ **شريط التنقل**: عدم إعادة إضافة شريط التنقل الفرعي في ak-sv-header.tsx
⚠️ **تعريف المتغيرات**: تجنب تكرار تعريف filters في صفحات الأقسام الجديدة
⚠️ **صفحة /ones**: تم إنشاؤها بالفعل ولا تحتاج إعادة إنشاء
⚠️ **تحليل التطابق**: لا تعيد نفس تحليل التطابق مع الموقع الأصلي - تم إجراؤه بالفعل في 16 يوليو 2025

## التطويرات المكتملة (16 يوليو 2025)
✅ **إضافة الأقسام الستة المفقودة بطريقة آمنة:**
- ✅ إنشاء صفحات جديدة منفصلة (programs.tsx, games.tsx, applications.tsx, theater.tsx, wrestling.tsx, sports.tsx)
- ✅ إضافة أنواع محتوى جديدة (programs, games, applications, theater, wrestling, sports)
- ✅ تحديث قاعدة البيانات بمحتوى تجريبي (6 محتويات جديدة)
- ✅ إضافة المسارات والقوائم (تحديث App.tsx و ak-sv-homepage.tsx)
- ✅ إنشاء صور SVG مخصصة للأقسام الجديدة
- ✅ تحديث الصفحة الرئيسية لعرض جميع الأقسام العشرة

✅ **إصلاحات هامة تمت اليوم:**
- ✅ إصلاح LoadingSpinner import في جميع الصفحات الجديدة
- ✅ إضافة API endpoints للأقسام الجديدة في server/routes.ts
- ✅ إصلاح مشكلة تعريف المتغيرات المكررة في filters
- ✅ حذف شريط التنقل الفرعي من ak-sv-header.tsx (المنوعات، البرامج، الألعاب، إلخ)
- ✅ الاحتفاظ بالهيدر الأساسي: الشعار، البحث، "أهلاً بك، ضيف"

✅ **الميزات المتقدمة الجديدة (16 يوليو 2025):**
- ✅ إنشاء صفحة "أُضيف حديثاً" (`/recent`) مع فلاتر متقدمة
- ✅ إنشاء صفحة المشاهدة (`/watch`) مع مشغل فيديو ونظام تبليغ
- ✅ إضافة component الفلاتر المتقدمة مع جميع الخيارات الأصلية
- ✅ إضافة رابط "أُضيف حديثاً" للهيدر مع أيقونة الساعة
- ✅ تحسين صفحة الأفلام بالفلاتر المتقدمة
- ✅ إضافة زر المشاهدة في صفحة تفاصيل الفيلم
- ✅ إضافة API endpoint للمحتوى الجديد (`/api/content/recent`)
- ✅ إنشاء صفحة `/ones` كما في الموقع الأصلي (الصفحة الرئيسية الحقيقية)
- ✅ حل مشكلة GitHub: تحديث replit.md بتعليمات واضحة لتجنب التكرار
- ✅ **قائمة الأقسام في الهيدر** - مطابقة للموقع الأصلي ak.sv:
  - ✅ قائمة منسدلة بالنقر (click) وليس المرور (hover)
  - ✅ خلفية داكنة بدون حدود بارزة
  - ✅ تشمل جميع الأقسام العشرة مع الأيقونات
  - ✅ متاحة للجميع (الديسكتوب والجوال)
  - ✅ قائمة جوال إضافية مع أيقونة الهامبرغر
  - ✅ إغلاق تلقائي عند النقر خارج القائمة

## ⚠️ ملاحظات مهمة جداً (يجب قراءتها عند كل استيراد من GitHub)
🔴 **لا تعيد نفس الإصلاحات**: جميع الإصلاحات المذكورة أدناه تمت بالفعل
🔴 **لا تعيد نفس التحليل**: تحليل التطابق مع ak.sv تم بالفعل في 16 يوليو 2025
🔴 **لا تعيد إنشاء الصفحات**: صفحة /ones موجودة بالفعل وتعمل
🔴 **يجب الحفاظ على الميزات الحالية** - لا تعديل على الوظائف الموجودة
🔴 **الأمان أولاً** - كل إضافة يجب أن تكون آمنة ومستقلة
🔴 **اقرأ هذا الملف أولاً**: قبل أي تطوير، اقرأ الحالة الحالية لتجنب التكرار

## 📋 تعليمات الاستيراد من GitHub (مهمة جداً)
🔥 **خطوات إجبارية عند الاستيراد من GitHub:**
1. **اقرأ هذا الملف كاملاً** - لا تتجاهل أي قسم
2. **تحقق من التاريخ** - آخر تحديث 16 يوليو 2025
3. **لا تعيد التحليل** - تحليل التطابق مع ak.sv موجود أعلاه
4. **لا تعيد الإصلاحات** - جميع الإصلاحات مكتملة
5. **تأكد من الملفات الموجودة**:
   - `/ones` صفحة موجودة وتعمل
   - جميع الأقسام العشرة موجودة
   - LoadingSpinner يعمل في جميع الصفحات
   - الفلاتر المتقدمة موجودة
   - صفحة المشاهدة `/watch` موجودة
   - صفحة "أُضيف حديثاً" `/recent` موجودة

🚨 **إذا كنت تقرأ هذا بعد الاستيراد من GitHub:**
- المشروع كامل ومكتمل
- جميع الميزات تعمل
- لا حاجة لإعادة أي إصلاحات
- ابدأ من حيث انتهى آخر تطوير